---
title: 《鸟哥的LINUX私房菜_服务器篇》笔记
tags: 操作系统OS
---

# 《鸟哥的LINUX私房菜_服务器篇》笔记

# 基础网络概念

## 计算机联网结构

![image-20220112163724225](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20220112163724225.png)

- 网络接口

  利用软件设计的网络接口，主要是提供网络地址IP

  一张网卡至少可以搭配一个以上的网络接口

  每部主机内部也有一个内部接口，**loopback（lo）**循环测试接口。

- 网络形态或拓扑结构

  各个节点在网络上的链接方式，一般指物理方式。

  上图则为星形拓扑结构。

- 网关（route/gateway)

  具有两个以上的网络接口，可以连接两个以上不同的网段的设备。如IP分享器

### 局域网网络架构



## TCP/IP的数据链路层

主要是以太网的相关概念

- 局域网网络结构

  <img src="https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20220112164600244.png" alt="image-20220112164600244" style="zoom:80%;" />

  以太网的传输主要是**网络卡对网络卡**之间的数据传递

  每个主机都是联机到集线器(hub/switch)，然后通过集线器向所有主机发起联机

  每个以太网网卡出厂时，赋予一个独一无二的MAC卡号，一般不能被修改

  使用CSMA/CD协议进行通讯

- 可以使用MAC通讯

  ![image-20220112165013271](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20220112165013271.png)

  MAC不能跨局域网通信！

## TCP/IP的网络层

关于IP相关参数可以做如下假设，来理解：

> 在某一街道的所有用户作为主机，门牌号想象为IP
>
> - 网域：只要在这条街上都是一个网域
> - Network IP：这个街道的第一个门牌，代表整个街道，整个网域
> - Broadcast IP：街道的最后一个门牌
> - 路由器：这个街道的邮局，要想发送数据给其他街道的用户，只需要把数据给邮局进行转发即可

主机连上Internet的必须参数如下：

![image-20220112175213706](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20220112175213706.png)

### 一些概念

#### 网段与网域

- 物理网段

  当所有的主机都使用同一个网络媒体串在一起，这个时候这些主机在实体装置上其实是联机在一起的，那么就可以称为在同一个物理网段。

  同一个物理网段，主机可以直接通过MAC通信，也可以通过广播进行网络联机

- 网域

  IP地址的网络号相同，主机号不同

- IP网段

  同一个物理网段内，可以依据不同的IP设定，设置为多个IP网段

#### Network与Broadcast

- 全0的主机号，表示整个网段的地址(Network IP)

  网域的第一个IP

- 全1的主机号，表示广播地址（Broadcast IP）

  网域的最后一个IP

  广播地址不同的两个主机的通信，需要使用路由器(router)

#### loopback IP

作为内部循环测试的网络接口，没有网卡也可以使用。

一般为127.0.0.0/8，是个Class A。

#### Netmask

子网掩码，网络号全1，主机号全0。

划分子网的作用，标识网络号的位置。

#### CIDR

无等级网域间路由，在IP后标出网络号的位数

`IP/net number`，如`192.168.0.0/24`

**通常表示一个网段会使用`NetWork/Netmask`的方式**，由此就可以算出Broadcast和可用IP。

### IP分级

![image-20220112171210942](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20220112171210942.png)![image-20220112171219612](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20220112171219612.png)

### IP分类

- Public IP

  公共IP，有这个IP才能连上Internet

- Private IP

  不能直接连上Internet的IP，主要用于局域网的主机联机

  ![image-20220112171648445](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20220112171648445.png)

  在私有IP后加上NAT服务即可连上Internet

### 路由

- 两个主机在两个网段时，不能直接IP广播通信，只能借助路由器

![image-20220112173211096](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20220112173211096.png)

- 在主机查询路由表时，没有符号的路由，就会把IP包送去预设路由器（默认网关，default gatway）

- 观察主机路由`route`命令

  ![image-20220112173649795](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20220112173649795.png)

  输出一共有8个字段，按顺序是：

  - Destination

    就是Network。

    字段为default时，表示当要去的网域不在其他Destination列表内时，通过default这行的gateway转发出去。

  - Gateway

    该网络接口的gateway的IP

    若为0.0.0.0即为不需要额外的IP

  - Genmask

    就是Netmask

  - Flags

    U：代表路由可用

    G：代表网域需要经过Gateway准发

    H：代表该路由为一部主机，而非整个网域

  - Metric

  - Ref

  - Use

  - Iface

    Interface（网络接口），表示要去本机要去这个Destination需要走的网络接口

