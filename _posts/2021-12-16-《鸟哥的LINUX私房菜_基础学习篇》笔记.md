---
title: 《鸟哥的LINUX私房菜_基础学习篇》笔记
tags: 操作系统OS
---

# 《鸟哥的LINUX私房菜_基础学习篇》笔记

# 计算机概论

## 计算机五大单元

主要分为三部分：**输入单元、中央处理器(CPU)、输出单元**

五大单元：输入单元、输出单元、CPU内部的控制单元、算术逻辑单元、内存。

<img src="https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211216154107969.png" alt="image-20211216154107969" style="zoom:70%;" />

### CPU

#### 种类

​	我们所使用的软件都要经过CPU内部的**微指令集**来完成才行。

​	指令集的设计分为两种设计理念，即两种主要的CPU种类：

- 精简指令集RISC
  - 每个指令执行时间短，性能较佳，但要做复杂的事情需要多个指令完成。
  - 常见CPU公司：Sun的SPARC系列，IBM的Power Architecture系列和**ARM**系列
  - 常见于，学术大型工作站一般使用SPARC；品牌手机、导航系统、网络交换机、路由器等都是**ARM，是目前世界上使用范围最广的CPU**
- 复杂指令集CISC
  - 指令数目多而且复杂，花费时间长，但每个指令可以处理复杂的工作。
  - 常见有AMD、Intel、VIA等x86架构等CPU。x86架构CPU被大量用于个人计算机。
  - **x86名字的由来，是因为最早的那个Intel发展的CPU代号8086，后面又有80286，80386等，所以这种架构的CPU就称为x86架构**。2003年后，Intel的x86架构CPU由8位升级到16、32位，后来**AMD依次架构修改为64位CPU**，为了区别两者，64位的个人计算机CPU统称为X86_64架构。

#### CPU频率

- 概念

  CPU每秒钟可以进行的工作次数。

  >  CPU频率位3.0GHz，表示CPU在一秒内可以进行3.0*10^9次工作，**每次工作可以进行少数的指令运行**。

- 外频与倍频

  CPU与外部各组件速度不一致，很多数据都在CPU内处理，故开发商在CPU内再加上一个加速功能。

  - 外频，CPU与外部组件进行数据传输/运算的速度
  - 倍频，CPU内部用来加速工作性能的一个倍数

  两者相乘才是CPU频率。

  > 上面例子CPU频率3.0GHz，而外频是333MHz，那么倍频就是9倍。

#### 32位与64位

​	总线宽度可以分为32/64bit。总线速度 = 总线传输速度(频率) * 总线宽度。

​	CPU每次能够处理的数据量称为**字组大小**，依据CPU的设计而有32位和64位。**现在所称的计算机是32位或是64位主要是依据CPU解析字组大小而来**。CPU每次能解析的数据量有限，因此内存传来的数据量就有所限制。

​	**字组大小和总线宽度可以不同**。

#### CPU等级

​	1993年左右，x86架构的CPU在intel的Pentium系列后设计不统一，出现i386、i586、i686等名词出现。

- 在Intel Pentium MMX与AMD K6年代的CPU统称为i586等级
- Intel Celeron与AMD Athlon(K7)年代之后的32位CPU称为i686等级
- 目前64位CPU则统称为x86_64等级。

### 内存

​	不论是软件程序还是数据，都必须要读如内存后CPU才能使用。

#### 内存组件

​	个人PC中主要位动态随机访问内存（DRAM）。断电后数据消失，也称为**挥发性内存**。

​	通常内存越大表示系统越快，因为系统不用常常释放一些内存内部的数据。**对服务器而言，内存的容量有时比CPU的速度还重要**。

![image-20211216164842031](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211216164842031.png)

​	**理论上，CPU与内存的外频应该要相同才好**。

#### 双通道设计

​	传统总线宽度仅为64位，为了加大这个宽度，可以将两个内存汇整在一起，则可以达到128位。数据可以同步写入/读出内存中，提升整体的频宽。

​	开启双通道的内存，容量和型号最好相同！

#### 第二缓存

​	为了某些常用的程序或者数据可以放置到CPU内部而设计，那么CPU数据的读取就不需要通过北桥了。

<img src="https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211216165422900.png" alt="image-20211216165422900" style="zoom:50%;" />

​	第二缓存(L2 Cache)在CPU内部，故L2内存的速度必须要与CPU频率相同。DRAM无法到达，故使用SRAM。

## 常用计算单位

- 大小单位

  1Byte = 8bit

  ![image-20211216160717997](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211216160717997.png)

- 速度单位

  - CPU的运算速度常使用MHz或GHz
  - 网络常使用Mbit/s，即每秒多少Mbit

## 接口设备

​	单有CPU也无法运作计算机，需要其他的接口设备才能实际运行。

### 主板

#### 主板芯片组

- 负责将所有的设备连接在一起，让所有的设备能够进行协调与通信。主板上最重要的组件是主板**芯片组**。
- 芯片组通常分为两个桥接器来控制各组件的通信
  - 北桥负责连接速度较快的CPU、内存与显卡等组件。**北桥的总线称为系统总线**，因为是内存传输的主要信道。
  - 南桥负责连接速度较慢的周边接口，包括硬盘、USB、网卡等，**南桥的总线是输入输出总线(IO)**。
- 芯片组负责所有通信，所以也是一个可能会散发出高热量的组件。因此主板上面会发现一些外接的小风扇或者是散热片。

#### IO地址与IRQ中断信道

​	是主板芯片组和其他设备通信的具体通信方式。

- 每个设备都有自己的IO地址。一般不能有两个设备使用同一个IO地址（类比**门牌号**）
- 各设备可以通过IRQ中断通信信道来告知CPU该设备的工作情况，以方便CPU进行工作分配的任务。（类比**各个门牌连接到邮件中心CPU的专门路径。

#### CMOS与BIOS

- CMOS主要**记录主板上面的重要参数**，包括系统时间、CPU电压与频率、各项设备IO地址与IRQ等。**由于记录这些数据需要花费店里，故主板上面才有电池**。
- BIOS位写入到主板闪存或EEPROM的程序，他可以**在开机的时候执行**，以加载CMOS当中的参数，并尝试调用存储设备中的开机程序，进行一步进入操作系统。

### 存储设备

​	存储设备包括：硬盘、软盘、MO、CD、DVD、U盘等。其中最常见的是**硬盘**。

#### 硬盘的物理组成

​	主要由很多的盘片、机械手臂、磁头与主轴马达组成。实际的数据写在具有磁性物质的盘片上。

![image-20211217173130463](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211217173130463.png)

#### 盘片的数据

![image-20211217173212439](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211217173212439.png)



- 扇区：由同心圆以放射状的方式分割出磁盘的**最小存储单位**，每个扇区大小**512bytes**，**这个值是固定的**。

- 磁道：扇区组成的一个就是磁道。

- 柱面：在多磁盘上面，同一个磁道可以组成一个柱面，**也是一般分割磁盘时的最小单位**。

#### 传输接口

- IDE接口

- SATA接口

  排线较细小，有利于主机壳内部的散热与安装。

  目前主流的个人计算机硬盘已经被SATA代替了。SATA-2传输速度可达300MB/s。

  ![image-20211217174256889](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211217174256889.png)

- SCSI接口

  用于工作站等级以上的硬盘传输接口。硬盘的控制器含有一块处理器。

#### 一些参数

- 容量

- 缓冲存储器

  硬盘还有一个缓冲存储器，将硬盘内常用的数据缓存起来。这个缓冲器越大越好。

- 转速

  指主轴马达转动盘片的速度，影响读取数据性能。越高越好。

### 显示设备

- 概念

  显卡又称VGA(Video Graphics Array)。每个图像显示的颜色都会占用内存，所以显卡上面有一个内存容量，它将影响到最终屏幕分辨率和色彩深度。

- GPU

  显卡厂商为了缓解CPU进行3D运算压力，直接在显卡上面嵌入一个3D加速的芯片，即GPU由来。

- 与CPU通信

  通过北桥芯片与CPU、内存通信。

  也是需要告诉运算的组件，所以数据的传输速度越快越好。显卡规格变化：PCI ---》AGP ---》PCI-Express(PCIe)。他们主要区别在数据传输的频宽。

  ![image-20211217172647532](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211217172647532.png)

  ![image-20211217172702238](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211217172702238.png)

### 网络设备

### 其他设备

#### PCI(e)适配卡

​	提供多个PCI(e)插槽给用户插入其他功能卡。

## 操作系统

​	提供一个开发软件的操作接口给工程师开发软件，通过接口即可驱动所有的硬件。

​	**操作系统其实也是一组程序**，这组程序的重点在于管理计算机的所有活动以及驱动系统中的所有硬件。

### 内核

​	让CPU开始判断逻辑与运算数值，让内存开始读取数据与程序代码，让硬盘开始被访问等。硬件的所有操作都必须通过操作系统完成。**这就是操作系统内核的功能**。

​	主要在于管控硬件与提供相关的能力，非常重要，因此**内核程序所放置到内存当中的区块是受保护的，并且开机后就一直常驻内存**。

**内核通常包含一些功能**：

- 提供系统调用接口
- 程序管理：CPU调度机制有较加快整体系统性能
- 内存管理
- 文件系统管理
- 设备驱动

### 系统调用

​	<img src="https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211218164627436.png" alt="image-20211218164627436" style="zoom:50%;" />

​	为了保护内核，并且而让程序员比较容易开发软件，因此操作系统除了内核程序之外，通常还会提供一整组开发接口，那就是**系统调用**。

### 驱动程序

​	操作系统提供一个开发接口给硬件开发商，让他们可以根据这个接口设计可以驱动他们硬件的驱动程序，安装后就可以在操作系统上驱动硬件设备。

<img src="https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211218170823839.png" alt="image-20211218170823839" style="zoom:50%;" />

# Linux简介

​	提供了一个完整的操作系统当中最底层的硬件控制与资源管理的完整架构，是沿袭Unix良好的传统而来的（UNIX Like 系统），所以**相当稳定并且功能强大，且可以在目前的个人计算机（x86系统）上面跑。**

## 一些历史

- UNIX

  - 1973年，UNIX正式诞生，Ritchie等人以C语言写出第一个正式UNIX内核。
  - 1977年，UNIX的重要分支**BSD（Berkeley Software Distribution, Bill Joy也是Sun的创办者)诞生**。
  - 1984年，x86架构的Minix操作系统诞生。
  - 1984年，Richard Mathew Stallman（史托曼）创建了**GNU项目，目的是创建一个自由、开放的UNIX操作系统（Free UNIX)**。1999年左右，创立**自由软件基金会（Free Software Foundation, FSF)**。1985年左右，为了避免GNU所开发的自由软件被其他人所利用而成为专利软件，与律师草拟了**通用公共许可证（General Public License, GPL）**，称为**CopyLeft（与专利软件的CopyRight相对）**。
  - 1988年，由MIT（麻省理工学院）成立了非营利性性质的**XFree86（X Windows System + Free + x86）**。后面在Linux的GUI发展中有贡献。

- Linux

  - 1991年，芬兰大学生Linus Torvalds，以bash，gcc(GNU C Complie, 一种c语言编译器)等工具写了一个小小的内核程序，且可以在386机器上面运行。
  
  - 期间，为了使LInux程序软件可以兼容UNIX，所以开始**参考POSIX规范修改Linux**。POSIX是可携式操作系统接口（Portable Operating System Interface)缩写，重点在于规范内核与应用程序之间的接口，由IEEE发布的一项标准。UNIX即按照这个规范来设计的。
  
  - 1994年，在广大网友合作下完成Linux的内核正式版Version 1.0。这一版本还有X Window System的支持。1996年完成2.0版本。
  
  - 为了让用户能够接触到Linux，很多的商业公司和团体奖Linux Kernel(含tools)与可运行的软件集成起来，放到光盘或网络给用户安装。这个**”Kernel + softwares + Tools"的可完全安装的系统，称为Linux distribution可完全安装套件**。
  
    distributions主要分为两大系统：
  
    - 使用RPM安装软件的系统，如Red Hat, Fedora, SuSE等。
  
    - 使用Debian等dpkg方式安装软件等系统，如Debian, Ubuntu, B2D等。
## Linux特色

- 配置需求低廉
- 系统稳定
- 保密功能强
- 架构开放，开源，免费或少许费用
- 多任务、多用户

## Linux文件

​	**在Linux系统中，每个设备都被当成一个文件来对待**。常见设备与对应Linux文件名如下：

![image-20211220105319380](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211220105319380.png)

​	几乎所有的硬件设备文件都在`/dev`这个目录内。

## Linux磁盘分区

### 磁盘分区文件

​	**整块磁盘的第一个扇区特别重要**，记录了整块磁盘的重要信息。主要有两个重要的信息：

- 主引导分区（Master Boot Record， MBR）：可以安装引导加载程序的地方，有446bytes。
- 分区表（partition table）：记录整块磁盘分区的状态，有64bytes。

### 分区表

​	分区的最小单位为**柱面**。分区是以**柱面号码**的方式记录，在分区表的64bytes中，总共分为**四组记录区**，每组及录取记录该区段的**起始与结束的柱面号码**。

​	分区表64bytes最多容纳四个分区，这四个分区被称为**主(Primary)分区**，若主分区被继续划分，则成为**扩展(Extended)分区**。

![image-20211220110119164](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211220110119164.png)

​	假设硬盘为/dev/hda，则四个区的文件名为如下，其中后面跟的数字，与该分区所在的位置有关。

- P1: /dev/hda1
- P2: /dev/hda2
- P3: /dev/hda3
- P4: /dev/hda4

### 扩展分区

​	Linux一块硬盘想分出不止四个分区，是可以的。**既然第一个分区所在的分区表只能记录四条数据，那可以利用额外的扇区来记录更多的分区信息**。

![image-20211220111330670](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211220111330670.png)



​	上图P1称为主分区，P2称为扩展分区，L[1-5]由P2继续切分而来称为**逻辑分区(logical partition)**。设备文件名如下。注意没有/dev/hda3和/dev/hda4。因为**前四个号码都是留给Primary或者Extended用的**

- P1: /dev/hda1
- P2: /dev/hda2
- L1: /dev/hda5
- L2: /dev/hda6
- L3: /dev/hda7
- L4: /dev/hda8
- L5: /dev/hda9

​	有几个注意点：

- 扩展分区最多只能有一个
- 能够被格式化后作为数据访问的分区为主分区和逻辑分区，扩展分区无法格式化
- 逻辑分区数量依操作系统不同，在Linux系统中，IDE硬盘最多59个逻辑分区（5-63号），SATA硬盘有11个逻辑分区（5号到15号）

### 建议的磁盘规划

- 简单的分区方法

  仅分出根目录与内存交换空间(/ 和 swap)。

  swap内存交换空间的功能是：当有数据被存放在物理内存里面，但是这些数据又不是常被CPU所取用时，那么这些不常被使用的程序将会被丢到硬盘的swap交换空间中，而将快速的物理内存空间释放出来给真正需要的程序使用。

- 稍微麻烦

  需要较大容量和读写频繁的目录，独立于根目录分区。常见容量大或读写频繁的目录：

  - /
  - /usr
  - /home
  - /var
  - swap

## Linux开机流程

### 正常开机

1. BIOS，开机主动执行的程序，会识别第一个可开机的设备（硬盘）。
2. MBR，第一个可开机设备的第一个扇区内的主引导分区块，内包含引导加载程序。
3. 引导加载程序（Boot loader），读取内核文件
   - 提供菜单：用户选择不同的开机选项，也是**多重引导**的重要功能。
   - 载入内核文件：直接指向可开机的程序区段来开始操作系统
   - 转交其他loader：将引导加载功能转交给其他loader负责。
4. 内核文件，内核文件工作，开始操作系统的功能。

### 多重引导

其中引导加载程序除了可以安装在MBR之外，还可以安装在每个分区的引导扇区(boot sector)，才有了**多重引导**功能。

![image-20211220134716538](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211220134716538.png)

​	每个分区都有自己的启动扇区，实际可开机的内核文件是放置在各分区内的。

​	loader只会认识自己的系统分区内的可开机内核文件和其他loader，loader可以直接指向或是间接将管理权转交另一个管理程序。

## Linux文件结构和磁盘挂载

- 文件结构

​	Linux使用**目录树**结构，以根目录（/）为主，然后向下呈现分枝状的目录结构的一种文件结构。

​	如何结合目录树的架构与磁盘内的数据，这个时候就牵扯到“挂载”（mount）问题。

![image-20211222142446218](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211222142446218.png)

- 磁盘挂载

  利用一个目录当进入点，将磁盘分区的数据放置在该目录下，即**进入该目录就可以读取该分区**。这个操作成为**挂载**，进入点的目录成为**挂载点**。

  如下图，当数据放置在/home内的各个目录时，数据放置在partition2分区；当数据放置在其他目录时，数据放置在partiton1目录。

![image-20211222142819962](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211222142819962.png)



## Linux启动

​	在Linux默认登录模式中，主要分为两种：

- 纯文本界面（运行等级 run level 3)，可以拥有tty1~tty6的终端界面。
- 图形界面（运行等级 run level 5），拥有tty1~tty7。其中tty7就是开机后等待登录的图形环境。

登录环境的切换：

- [Ctrl] + [Alt] + [F1] ~ [F6]：文字界面登录tty1~tty6终端
- [Ctrl] + [Alt] + [F7]：图形界面桌面

## Linux命令行和简单命令

### 可以输入多条命令

​	使用**分号(;)**隔开多条命令，命令按顺序执行。

### 用户符号区别

- 普通用户

  [xxx@xxx ~]$，其中`~`代表的是用户的主文件夹，即/home/username文件夹

- root

  [xxx@xxx ~]#，命令提示符和普通用户不一样，且~代表/root文件夹

### 执行命令的查询路径PATH

- 概念

  在终端执行命令的时候，其实由一个同名的可执行文件存在。系统会按照PATH的设置去每个PATH定义的目录下查询可执行文件，如果有多个同名的可执行文件，先查到的可执行文件先执行。

- 查看PATH

  ```shell
  echo $PATH
  ```

  每个目录之间以冒号(:)隔开，有顺序之分。

- 一些事项

  - 不同身份用户默认的PATH不同，默认能够随意执行的命令也不同
  - **使用绝对路径或相对路径直接指定命令的文件名来执行，会比查询PATH来的正确**

### 开关机相关命令

- 将数据同步写入硬盘

  ```shell
  sync
  ```

- 退出登录

  注销Linux，退出登录状态。

  ```shell
  exit
  ```

- 关机

  ```shel
  shutdown
  poweroff
  ```

- 重启

  ```shell
  reboot
  ```

### 基础操作命令

​	在Linux中，不一样的大小写代表不同命令，即**大小写敏感**。

- 显示日期和时间

  ```shell
  data
  ```

- 显示日历

  ```shell
  cal
  ```

- 简单计算器

  ```shell
  bc
  ```

### 重要的热键

- [Tab]

  具有“命令补齐”和“文件补齐”功能。

- [Ctrl] + C

  中断当前程序。但对于比较重要的命令慎用。

- [Ctrl] + D

  代表**键盘输入结束**。也可以代替`exit`命令。

### 查询命令 man

​	man是manual（操作说明）的简写。查询的结果页面称为man page。

- man page存放位置

  一般为`/usr/share/man`，可以修改`/etc/man.config`或`/ect/man.conf`或`/etc/manpath.conf`来改变man page的查询路径。

- 使用方法

```shell
man command
```

<img src="https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211222153617005.png" alt="image-20211222153617005" style="zoom:80%;" />

- 一些操作

  ![image-20211222154010796](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211222154010796.png)

- man page简单解析

  - 第一行，命令后面的数字的含义

  ![image-20211222153704567](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211222153704567.png)

  - 其他参数

    ![image-20211222154050586](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211222154050586.png)

### 查询命令 info

​	和man类似，但输出格式有所不同。

### 查看Linux内核信息命令

- 查看实际的内核版本

```shell
uname -r
```

- 查看distribution信息

```shell
lsb_release -a
```



# Linux文件系统

​	Linux使用Ext2/Ext3作为文件系统。

## 文件属性与权限

​	任何一个文件都具有User、Group和Others 三种等级权限。root可以查看所有文件。

![image-20211223104508097](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211223104508097.png)

### 文件属性

#### 属性查看

- 使用`ls -al`命令可以查看当前文件下所有的文件详细的属性与权限。

  ![image-20211223104925835](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211223104925835.png)

- 参数

  ![image-20211223105504819](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211223105504819.png)

  | 权限       | 连接 | 所有者 | 用户组 | 文件容量 | 修改日期    | 文件名      |
  | ---------- | ---- | ------ | ------ | -------- | ----------- | ----------- |
  | drwx------ | 3    | root   | root   | 4096     | Sep 5 10:37 | .gconf      |
  | -rw-r--r-- | 1    | root   | root   | 42304    | Sep 4 18:26 | install.log |

#### 属性解析

- 第一列，文件类型与权限

  一共10个字符。

  ![image-20211223105515659](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211223105515659.png)

  第一个字符代表文件是“目录、文件或链接文件等”

  - [d]是目录
  - [-]是文件
  - [l]表示连接文件（linkfile）
  - [b]表示可供存储的接口设备
  - [c]表示串行端口设备，如键盘、鼠标等

  后面9个字符，3个分为一组"rwx"的组合，r为可读，w为可写，x为可执行。如果没有相应权限，用[-]代替。

  - 第一组，**文件所有者的权限**
  - 第二组，**用户组的权限**
  - 第三组，**其他人的权限**

  **特别注意这些权限对于文件和目录的意义**:

  - 对于文件的意义

    特别对于w权限，具有**写入、编辑、新增、修改**文件的内容的权限，但**并不具备删除该文件本身的权限**。

  - 对于目录的意义

    - r权限，表示可以读取目录下的文件名数据

    - w权限，表示具有更改目录结构列表的权限，包括：

      - 新建新的文件和目录
      - 删除文件和目录
      - 重命名文件和目录
      - 转移该目录内的文件、目录位置

    - x权限，表示用户能否进入该目录成为工作目录

      即cd命令能否进入

- 第二列，有多少文件名连接到此节点

  每个文件都会将权限与属性记录到文件系统的i-node中。这个属性记录有多少不同的文件名连接到相同的一个i-node号码。

- 第三列，表示文件所有者账号

- 第四列，表示文件的所属用户组

- 第五列，文件容量的大小，默认为**B**

- 第六列，这个文件的创建文件日期或最近的修改日期

  ​	特别注意一下文件的时间，Linux下面会记录许多的时间参数，其中有三个主要的变动时间。**ls默认显示的是mtime**。

  - modification time(mtime)

    文件的“内容数据”（不是文件属性或权限）改变时，更新mtime

  - status time(ctime)

    文件的“状态”（权限或属性被修改等）改变时，更新ctime

  - access time(atime)

    当“文件的内容被读取”（如使用cat命令)时，更新atime

- 第七列，文件名。

  隐藏文件，文件名有个`.`

### 改变文件属性与权限

#### 改变文件所属用户组 chgrp

​	注意，改变后的组名要在`/etc/group`文件中才行。

```shell
chgrp [-R] groupname filename
```

#### 改变文件所有者 chown

​	注意，改变后的用户要在`/etc/password`文件中才行。此外，还可以顺便改变用户组。

```shell
chown [-R] username filenmae

chown [-R] username:groupname filename
```

​	使用环境，如`cp`命令，复制文件时，会同时复制执行者的属性与权限，可能需要改变权限。

#### 改变文件的权限 chmod

​	用来改变文件的权限，有两种方式：数字、符号。

- 数字类型

  使用数字来代替`rwx`。

  - r:4
  - w:2
  - x:1
  - -:0

  每组权限`rwx`的权限数字，是对应的数字相加。如：

  > owner = rwx = 4 + 2 + 1 = 7
  >
  > group = rwx = 4 + 2 + 1 = 7
  >
  > others = --- = 0 + 0 +0

  命令使用方式：

  ```shell
  chmod [-R] xyz filename
  ```

- 符号类型

  使用u, g, o分别代替user 、group、others三种身份，a代表all，即全部身份。

  ![image-20211223112151967](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211223112151967.png)

  ```shell
  chmod u=rwx, go=rx filename
  
  chmod a+x filename
  ```

### 文件的默认权限

​	在新建文件或目录时候的权限默认值，由umask指定。

​	umask是四个数字，如`0022`，与一般权限有关的后三个数字，分别表示user、group、others需要**在默认权限的基础上拿掉的权限**。比如这里group和others需要去掉`w`权限。

![image-20211224112749847](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211224112749847.png)

```shell
umask xxx #直接设置ugo需要去掉的权限
```

#### 默认情况的权限

- 若用户创建“文件”，**默认没有可执行`x`权限**，只有`rw`权限，所有最大为666，即默认权限为：

  `-rw-rw-rw-`

- 若用户创建“目录”，默认为777，即

  `drwxrwxrwx`

#### 设置umask后的权限

​	比如若umask为`0022`

- 新建文件时

  `-rw-rw-rw-` - `-----w--w-` = `-rw-r--r--`

- 新建目录时

  `drwxrwxrwx` - `d----w--w-` = `drwxr-xr-x`

### 文件的隐藏属性

#### 设置文件的隐藏属性

![image-20211224113249637](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211224113249637.png)

#### 显示文件隐藏属性

![image-20211224113314101](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211224113314101.png)

### 文件特殊权限

​	在Linux的一些特殊文件的权限里，如`/tmp`、`/usr/bin/passwd`等，有`s`、`t`等等权限。

![image-20211224133849294](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211224133849294.png)

#### SUID

​	`s`出现在文件所有者的`x`权限上时，称为Set UID，简称SUID权限。提供的功能：

- SUID权限仅对**二进制**程序有效
- 执行者对于该程序具有`x`的执行权限
- 本权限仅在执行该程序过程中有效
- 执行者将具有该程序所有者的权限

![image-20211224134144319](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211224134144319.png)

#### SGID

​	`s`出现在文件用户组的`x`权限上时，称为Set GID，简称SGID权限。如`/usr/bin/locate`文件。

对于**文件**提供的功能：

- SGID对二进制程序有用
- 程序执行者对该程序具有`x`权限
- 执行者在执行过程中获得该程序用户组的支持

对于**目录**提供的功能：

- 用户若对于此目录具有`rx`权限，则该用户能进入目录
- 用户对此目录的有效用户组会变成该目录的用户组
- 若用户再此目录下具有`w`权限，则用户创建的新文件的用户组与此目录的用户组相同

#### SBIT

​	Sticky Bit(SBIT)目前只针对目录有效，作用是：

> 若用户对目录具有`wx`权限，当用户在该目录下创建文件或目录时，仅有自己与root才有权利删除该文件。



## Linux文件目录

​	Filesystem Hierarchy Standard(FHS)标准，规定每个特定的Linux目录下应该要放置什么样子的数据。FHS定义出三层目录：

- / ，根目录，与开机系统有关
- /usr , Unix software resource，与软件安装有关
- /var，variable，与系统运作过程有关

### 四种交互作用形态

![image-20211223114038459](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211223114038459.png)

- 可分享的

  分享给其他系统挂载使用的目录

- 不可分享的

  仅与自身机器有关，不适合分享给其他主机

- 不变的

  有些数据不经常变动，跟随distribution而不变动。如函数库、文件说明文件等。

- 可变动的

  进程改变的数据，如登录文件等。

### 常见目录

#### 根目录(/)的内容

​	FHS建议，根目录所在分区应该越小越好，且应用程序所安装的软件最好不要与根目录放在同一个分区。

​	根目录与开机有关，**开机过程中仅有根目录会被挂载**，其他分区在开机后陆续进行挂载。下面这些目录一定要和根目录放在同一分区下：

- /etc 配置文件
- /bin 重要执行文件
- /dev 需要的设备文件
- /lib 执行文件所需要的函数库与内核所需的模块
- /sbin 重要的系统执行文件

​	根目录下的常见子目录如下：

![image-20211223114837952](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211223114837952.png)

![image-20211223114851313](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211223114851313.png)

#### `/usr`的内容

​	是所有系统默认软件的安装目录。/usr的子目录建议有下列：

![image-20211223151450942](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211223151450942.png)

​	

#### `/var`内容

​	在系统运行之后逐渐填满容量的目录，包括缓存、登录文件、软件运行所产生的文件等。

![image-20211223152046728](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211223152046728.png)

### 绝对路径和相对路径

- 绝对路径：由根目录(/)开始写起的文件名或目录名称
- 相对路径：相对当前路径的文件名写法。`./xx`，`../xx`，`xx/xx`等
  - `.`代表当前目录
  - `..`代表上一层目录

## Linux文件命令

### 目录相关命令

#### 切换目录cd

```shell
cd
```

#### 显示当前目录pwd

```shell
pwd [-P]
```

-P参数显示出当前路径，而非连接路径

#### 新建目录mkdir

```shell
mkdir [-mp] filename
```

- -m 777

  配置文件的权限

- -p filename1/filename2

  递归创建目录

#### 删除一个空的目录rmdir

```shell
rmdir [-p] filename
```

递归删除目录

#### 查看文件与目录ls

![image-20211223171658704](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211223171658704.png)

![image-20211223171810849](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211223171810849.png)

​	其中`ls -l`命令有个别名为`ll`。

#### 复制cp

![image-20211223171917441](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211223171917441.png)

​	特别注意，**在默认的条件中，cp的源文件与目的文件的权限是不同的，目的文件的所有者通常会是命令操作者本身**。

#### 移除rm

![image-20211223172715286](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211223172715286.png)

#### 移动mv

![image-20211223172939196](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211223172939196.png)

#### 取路径的文件名basename和目录名称dirname

![image-20211223173744142](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211223173744142.png)

### 文件内容相关

#### 从第一开始显示cat

![image-20211223174226131](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211223174226131.png)

#### 从最后一行开始显示tac

```shell
tac filename
```

#### 带行号输出nl

![image-20211223174807041](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211223174807041.png)

#### 一页一页显示more

```shell
more filename
```

可用的操作：

- 空格键，向下翻一页
- Enter，向下滚动一行
- /字符串，向下查询“字符串”关键字
- :f，立刻显示出文件名以及目前显示的行数
- q，立刻离开more，不再显示该文件内容
- b或[Ctrl]+b，往回翻页

#### 可以往前翻页显示less

​	在more的功能基础上，加上往前翻页的功能

```shell
less filename
```

​	可用的操作：

- 空格键，往下翻一页
- [PageDown]，往下翻一页
- [PageUp]，往上翻一页
- /字符串，向下查询“字符串”的功能
- ?字符串，向上查询“字符串”的功能
- n，重复前一个查询（与/或?有关）
- N，反向重复前一个查询（与/或?有关）
- q，离开less这个程序

#### 只看头几行head

![image-20211223180110583](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211223180110583.png)

#### 只看结尾几行tail

![image-20211223180132401](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211223180132401.png)

#### 二进制方式读取文件od

![image-20211223180349752](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211223180349752.png)

#### 修改文件时间或创建新文件touch

![image-20211224104756745](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211224104756745.png)

