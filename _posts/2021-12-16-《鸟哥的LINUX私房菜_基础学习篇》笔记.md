---
title: 《鸟哥的LINUX私房菜_基础学习篇》笔记
tags: 操作系统OS
---

# 《鸟哥的LINUX私房菜_基础学习篇》笔记

# 计算机概论

## 计算机五大单元

主要分为三部分：**输入单元、中央处理器(CPU)、输出单元**

五大单元：输入单元、输出单元、CPU内部的控制单元、算术逻辑单元、内存。

<img src="https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211216154107969.png" alt="image-20211216154107969" style="zoom:70%;" />

### CPU

#### 种类

​	我们所使用的软件都要经过CPU内部的**微指令集**来完成才行。

​	指令集的设计分为两种设计理念，即两种主要的CPU种类：

- 精简指令集RISC
  - 每个指令执行时间短，性能较佳，但要做复杂的事情需要多个指令完成。
  - 常见CPU公司：Sun的SPARC系列，IBM的Power Architecture系列和**ARM**系列
  - 常见于，学术大型工作站一般使用SPARC；品牌手机、导航系统、网络交换机、路由器等都是**ARM，是目前世界上使用范围最广的CPU**
- 复杂指令集CISC
  - 指令数目多而且复杂，花费时间长，但每个指令可以处理复杂的工作。
  - 常见有AMD、Intel、VIA等x86架构等CPU。x86架构CPU被大量用于个人计算机。
  - **x86名字的由来，是因为最早的那个Intel发展的CPU代号8086，后面又有80286，80386等，所以这种架构的CPU就称为x86架构**。2003年后，Intel的x86架构CPU由8位升级到16、32位，后来**AMD依次架构修改为64位CPU**，为了区别两者，64位的个人计算机CPU统称为X86_64架构。

#### CPU频率

- 概念

  CPU每秒钟可以进行的工作次数。

  >  CPU频率位3.0GHz，表示CPU在一秒内可以进行3.0*10^9次工作，**每次工作可以进行少数的指令运行**。

- 外频与倍频

  CPU与外部各组件速度不一致，很多数据都在CPU内处理，故开发商在CPU内再加上一个加速功能。

  - 外频，CPU与外部组件进行数据传输/运算的速度
  - 倍频，CPU内部用来加速工作性能的一个倍数

  两者相乘才是CPU频率。

  > 上面例子CPU频率3.0GHz，而外频是333MHz，那么倍频就是9倍。

#### 32位与64位

​	总线宽度可以分为32/64bit。总线速度 = 总线传输速度(频率) * 总线宽度。

​	CPU每次能够处理的数据量称为**字组大小**，依据CPU的设计而有32位和64位。**现在所称的计算机是32位或是64位主要是依据CPU解析字组大小而来**。CPU每次能解析的数据量有限，因此内存传来的数据量就有所限制。

​	**字组大小和总线宽度可以不同**。

#### CPU等级

​	1993年左右，x86架构的CPU在intel的Pentium系列后设计不统一，出现i386、i586、i686等名词出现。

- 在Intel Pentium MMX与AMD K6年代的CPU统称为i586等级
- Intel Celeron与AMD Athlon(K7)年代之后的32位CPU称为i686等级
- 目前64位CPU则统称为x86_64等级。

### 内存

​	不论是软件程序还是数据，都必须要读如内存后CPU才能使用。

#### 内存组件

​	个人PC中主要位动态随机访问内存（DRAM）。断电后数据消失，也称为**挥发性内存**。

​	通常内存越大表示系统越快，因为系统不用常常释放一些内存内部的数据。**对服务器而言，内存的容量有时比CPU的速度还重要**。

![image-20211216164842031](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211216164842031.png)

​	**理论上，CPU与内存的外频应该要相同才好**。

#### 双通道设计

​	传统总线宽度仅为64位，为了加大这个宽度，可以将两个内存汇整在一起，则可以达到128位。数据可以同步写入/读出内存中，提升整体的频宽。

​	开启双通道的内存，容量和型号最好相同！

#### 第二缓存

​	为了某些常用的程序或者数据可以放置到CPU内部而设计，那么CPU数据的读取就不需要通过北桥了。

<img src="https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211216165422900.png" alt="image-20211216165422900" style="zoom:50%;" />

​	第二缓存(L2 Cache)在CPU内部，故L2内存的速度必须要与CPU频率相同。DRAM无法到达，故使用SRAM。

## 常用计算单位

- 大小单位

  1Byte = 8bit

  ![image-20211216160717997](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211216160717997.png)

- 速度单位

  - CPU的运算速度常使用MHz或GHz
  - 网络常使用Mbit/s，即每秒多少Mbit

## 接口设备

​	单有CPU也无法运作计算机，需要其他的接口设备才能实际运行。

### 主板

#### 主板芯片组

- 负责将所有的设备连接在一起，让所有的设备能够进行协调与通信。主板上最重要的组件是主板**芯片组**。
- 芯片组通常分为两个桥接器来控制各组件的通信
  - 北桥负责连接速度较快的CPU、内存与显卡等组件。**北桥的总线称为系统总线**，因为是内存传输的主要信道。
  - 南桥负责连接速度较慢的周边接口，包括硬盘、USB、网卡等，**南桥的总线是输入输出总线(IO)**。
- 芯片组负责所有通信，所以也是一个可能会散发出高热量的组件。因此主板上面会发现一些外接的小风扇或者是散热片。

#### IO地址与IRQ中断信道

​	是主板芯片组和其他设备通信的具体通信方式。

- 每个设备都有自己的IO地址。一般不能有两个设备使用同一个IO地址（类比**门牌号**）
- 各设备可以通过IRQ中断通信信道来告知CPU该设备的工作情况，以方便CPU进行工作分配的任务。（类比**各个门牌连接到邮件中心CPU的专门路径。

#### CMOS与BIOS

- CMOS主要**记录主板上面的重要参数**，包括系统时间、CPU电压与频率、各项设备IO地址与IRQ等。**由于记录这些数据需要花费店里，故主板上面才有电池**。
- BIOS位写入到主板闪存或EEPROM的程序，他可以**在开机的时候执行**，以加载CMOS当中的参数，并尝试调用存储设备中的开机程序，进行一步进入操作系统。

### 存储设备

​	存储设备包括：硬盘、软盘、MO、CD、DVD、U盘等。其中最常见的是**硬盘**。

#### 硬盘的物理组成

​	主要由很多的盘片、机械手臂、磁头与主轴马达组成。实际的数据写在具有磁性物质的盘片上。

![image-20211217173130463](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211217173130463.png)

#### 盘片的数据

![image-20211217173212439](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211217173212439.png)



- 扇区：由同心圆以放射状的方式分割出磁盘的**最小存储单位**，每个扇区大小**512bytes**，**这个值是固定的**。

- 磁道：扇区组成的一个就是磁道。

- 柱面：在多磁盘上面，同一个磁道可以组成一个柱面，**也是一般分割磁盘时的最小单位**。

#### 传输接口

- IDE接口

- SATA接口

  排线较细小，有利于主机壳内部的散热与安装。

  目前主流的个人计算机硬盘已经被SATA代替了。SATA-2传输速度可达300MB/s。

  ![image-20211217174256889](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211217174256889.png)

- SCSI接口

  用于工作站等级以上的硬盘传输接口。硬盘的控制器含有一块处理器。

#### 一些参数

- 容量

- 缓冲存储器

  硬盘还有一个缓冲存储器，将硬盘内常用的数据缓存起来。这个缓冲器越大越好。

- 转速

  指主轴马达转动盘片的速度，影响读取数据性能。越高越好。

### 显示设备

- 概念

  显卡又称VGA(Video Graphics Array)。每个图像显示的颜色都会占用内存，所以显卡上面有一个内存容量，它将影响到最终屏幕分辨率和色彩深度。

- GPU

  显卡厂商为了缓解CPU进行3D运算压力，直接在显卡上面嵌入一个3D加速的芯片，即GPU由来。

- 与CPU通信

  通过北桥芯片与CPU、内存通信。

  也是需要告诉运算的组件，所以数据的传输速度越快越好。显卡规格变化：PCI ---》AGP ---》PCI-Express(PCIe)。他们主要区别在数据传输的频宽。

  ![image-20211217172647532](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211217172647532.png)

  ![image-20211217172702238](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211217172702238.png)

### 网络设备

### 其他设备

#### PCI(e)适配卡

​	提供多个PCI(e)插槽给用户插入其他功能卡。

## 操作系统

​	提供一个开发软件的操作接口给工程师开发软件，通过接口即可驱动所有的硬件。

​	**操作系统其实也是一组程序**，这组程序的重点在于管理计算机的所有活动以及驱动系统中的所有硬件。

### 内核

​	让CPU开始判断逻辑与运算数值，让内存开始读取数据与程序代码，让硬盘开始被访问等。硬件的所有操作都必须通过操作系统完成。**这就是操作系统内核的功能**。

​	主要在于管控硬件与提供相关的能力，非常重要，因此**内核程序所放置到内存当中的区块是受保护的，并且开机后就一直常驻内存**。

**内核通常包含一些功能**：

- 提供系统调用接口
- 程序管理：CPU调度机制有较加快整体系统性能
- 内存管理
- 文件系统管理
- 设备驱动

### 系统调用

​	<img src="https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211218164627436.png" alt="image-20211218164627436" style="zoom:50%;" />

​	为了保护内核，并且而让程序员比较容易开发软件，因此操作系统除了内核程序之外，通常还会提供一整组开发接口，那就是**系统调用**。

### 驱动程序

​	操作系统提供一个开发接口给硬件开发商，让他们可以根据这个接口设计可以驱动他们硬件的驱动程序，安装后就可以在操作系统上驱动硬件设备。

<img src="https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211218170823839.png" alt="image-20211218170823839" style="zoom:50%;" />

# Linux简介

​	提供了一个完整的操作系统当中最底层的硬件控制与资源管理的完整架构，是沿袭Unix良好的传统而来的（UNIX Like 系统），所以**相当稳定并且功能强大，且可以在目前的个人计算机（x86系统）上面跑。**

## 一些历史

- UNIX

  - 1973年，UNIX正式诞生，Ritchie等人以C语言写出第一个正式UNIX内核。
  - 1977年，UNIX的重要分支**BSD（Berkeley Software Distribution, Bill Joy也是Sun的创办者)诞生**。
  - 1984年，x86架构的Minix操作系统诞生。
  - 1984年，Richard Mathew Stallman（史托曼）创建了**GNU项目，目的是创建一个自由、开放的UNIX操作系统（Free UNIX)**。1999年左右，创立**自由软件基金会（Free Software Foundation, FSF)**。1985年左右，为了避免GNU所开发的自由软件被其他人所利用而成为专利软件，与律师草拟了**通用公共许可证（General Public License, GPL）**，称为**CopyLeft（与专利软件的CopyRight相对）**。
  - 1988年，由MIT（麻省理工学院）成立了非营利性性质的**XFree86（X Windows System + Free + x86）**。后面在Linux的GUI发展中有贡献。

- Linux

  - 1991年，芬兰大学生Linus Torvalds，以bash，gcc(GNU C Complie, 一种c语言编译器)等工具写了一个小小的内核程序，且可以在386机器上面运行。
  
  - 期间，为了使LInux程序软件可以兼容UNIX，所以开始**参考POSIX规范修改Linux**。POSIX是可携式操作系统接口（Portable Operating System Interface)缩写，重点在于规范内核与应用程序之间的接口，由IEEE发布的一项标准。UNIX即按照这个规范来设计的。
  
  - 1994年，在广大网友合作下完成Linux的内核正式版Version 1.0。这一版本还有X Window System的支持。1996年完成2.0版本。
  
  - 为了让用户能够接触到Linux，很多的商业公司和团体奖Linux Kernel(含tools)与可运行的软件集成起来，放到光盘或网络给用户安装。这个**”Kernel + softwares + Tools"的可完全安装的系统，称为Linux distribution可完全安装套件**。
  
    distributions主要分为两大系统：
  
    - 使用RPM安装软件的系统，如Red Hat, Fedora, SuSE等。
  
    - 使用Debian等dpkg方式安装软件等系统，如Debian, Ubuntu, B2D等。
## Linux特色

- 配置需求低廉
- 系统稳定
- 保密功能强
- 架构开放，开源，免费或少许费用
- 多任务、多用户

## Linux文件

​	**在Linux系统中，每个设备都被当成一个文件来对待**。常见设备与对应Linux文件名如下：

![image-20211220105319380](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211220105319380.png)

​	几乎所有的硬件设备文件都在`/dev`这个目录内。

## Linux磁盘分区

### 磁盘分区文件

​	**整块磁盘的第一个扇区特别重要**，记录了整块磁盘的重要信息。主要有两个重要的信息：

- 主引导分区（Master Boot Record， MBR）：可以安装引导加载程序的地方，有446bytes。
- 分区表（partition table）：记录整块磁盘分区的状态，有64bytes。

### 分区表

​	分区的最小单位为**柱面**。分区是以**柱面号码**的方式记录，在分区表的64bytes中，总共分为**四组记录区**，每组及录取记录该区段的**起始与结束的柱面号码**。

​	分区表64bytes最多容纳四个分区，这四个分区被称为**主(Primary)分区**，若主分区被继续划分，则成为**扩展(Extended)分区**。

![image-20211220110119164](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211220110119164.png)

​	假设硬盘为/dev/hda，则四个区的文件名为如下，其中后面跟的数字，与该分区所在的位置有关。

- P1: /dev/hda1
- P2: /dev/hda2
- P3: /dev/hda3
- P4: /dev/hda4

### 扩展分区

​	Linux一块硬盘想分出不止四个分区，是可以的。**既然第一个分区所在的分区表只能记录四条数据，那可以利用额外的扇区来记录更多的分区信息**。

![image-20211220111330670](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211220111330670.png)



​	上图P1称为主分区，P2称为扩展分区，L[1-5]由P2继续切分而来称为**逻辑分区(logical partition)**。设备文件名如下。注意没有/dev/hda3和/dev/hda4。因为**前四个号码都是留给Primary或者Extended用的**

- P1: /dev/hda1
- P2: /dev/hda2
- L1: /dev/hda5
- L2: /dev/hda6
- L3: /dev/hda7
- L4: /dev/hda8
- L5: /dev/hda9

​	有几个注意点：

- 扩展分区最多只能有一个
- 能够被格式化后作为数据访问的分区为主分区和逻辑分区，扩展分区无法格式化
- 逻辑分区数量依操作系统不同，在Linux系统中，IDE硬盘最多59个逻辑分区（5-63号），SATA硬盘有11个逻辑分区（5号到15号）

### 建议的磁盘规划

- 简单的分区方法

  仅分出根目录与内存交换空间(/ 和 swap)。

  swap内存交换空间的功能是：当有数据被存放在物理内存里面，但是这些数据又不是常被CPU所取用时，那么这些不常被使用的程序将会被丢到硬盘的swap交换空间中，而将快速的物理内存空间释放出来给真正需要的程序使用。

- 稍微麻烦

  需要较大容量和读写频繁的目录，独立于根目录分区。常见容量大或读写频繁的目录：

  - /
  - /usr
  - /home
  - /var
  - swap

## Linux开机流程

### 正常开机

1. BIOS，开机主动执行的程序，会识别第一个可开机的设备（硬盘）。
2. MBR，第一个可开机设备的第一个扇区内的主引导分区块，内包含引导加载程序。
3. 引导加载程序（Boot loader），读取内核文件
   - 提供菜单：用户选择不同的开机选项，也是**多重引导**的重要功能。
   - 载入内核文件：直接指向可开机的程序区段来开始操作系统
   - 转交其他loader：将引导加载功能转交给其他loader负责。
4. 内核文件，内核文件工作，开始操作系统的功能。

### 多重引导

其中引导加载程序除了可以安装在MBR之外，还可以安装在每个分区的引导扇区(boot sector)，才有了**多重引导**功能。

![image-20211220134716538](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211220134716538.png)

​	每个分区都有自己的启动扇区，实际可开机的内核文件是放置在各分区内的。

​	loader只会认识自己的系统分区内的可开机内核文件和其他loader，loader可以直接指向或是间接将管理权转交另一个管理程序。

## Linux文件结构和磁盘挂载

- 文件结构

​	Linux使用**目录树**结构，以根目录（/）为主，然后向下呈现分枝状的目录结构的一种文件结构。

​	如何结合目录树的架构与磁盘内的数据，这个时候就牵扯到“挂载”（mount）问题。

![image-20211222142446218](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211222142446218.png)

- 磁盘挂载

  利用一个目录当进入点，将磁盘分区的数据放置在该目录下，即**进入该目录就可以读取该分区**。这个操作成为**挂载**，进入点的目录成为**挂载点**。

  如下图，当数据放置在/home内的各个目录时，数据放置在partition2分区；当数据放置在其他目录时，数据放置在partiton1目录。

![image-20211222142819962](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211222142819962.png)



## Linux启动

​	在Linux默认登录模式中，主要分为两种：

- 纯文本界面（运行等级 run level 3)，可以拥有tty1~tty6的终端界面。
- 图形界面（运行等级 run level 5），拥有tty1~tty7。其中tty7就是开机后等待登录的图形环境。

登录环境的切换：

- [Ctrl] + [Alt] + [F1] ~ [F6]：文字界面登录tty1~tty6终端
- [Ctrl] + [Alt] + [F7]：图形界面桌面

## Linux命令行和简单命令

### 用户符号区别

- 普通用户

  [xxx@xxx ~]$，其中`~`代表的是用户的主文件夹，即/home/username文件夹

- root

  [xxx@xxx ~]#，命令提示符和普通用户不一样，且~代表/root文件夹

### 开关机相关

- 将数据同步写入硬盘

  ```shell
  sync
  ```

- 退出登录

  注销Linux，退出登录状态。

  ```shell
  exit
  ```

- 关机

  ```shel
  shutdown
  poweroff
  ```

- 重启

  ```shell
  reboot
  ```

### 基础操作命令

​	在Linux中，不一样的大小写代表不同命令，即**大小写敏感**。

- 显示日期和时间

  ```shell
  data
  ```

- 显示日历

  ```shell
  cal
  ```

- 简单计算器

  ```shell
  bc
  ```

### 重要的热键

- [Tab]

  具有“命令补齐”和“文件补齐”功能。

- [Ctrl] + C

  中断当前程序。但对于比较重要的命令慎用。

- [Ctrl] + D

  代表**键盘输入结束**。也可以代替`exit`命令。

### 查询命令 man

​	man是manual（操作说明）的简写。查询的结果页面称为man page。

- man page存放位置

  一般为`/usr/share/man`，可以修改`/etc/man.config`或`/ect/man.conf`或`/etc/manpath.conf`来改变man page的查询路径。

- 使用方法

```shell
man command
```

<img src="https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211222153617005.png" alt="image-20211222153617005" style="zoom:80%;" />

- 一些操作

  ![image-20211222154010796](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211222154010796.png)

- man page简单解析

  - 第一行，命令后面的数字的含义

  ![image-20211222153704567](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211222153704567.png)

  - 其他参数

    ![image-20211222154050586](https://gitee.com/Object_Jason/my-pic-go/raw/master/img/image-20211222154050586.png)

### 查询命令 info

​	和man类似，但输出格式有所不同。

# Linux文件系统

